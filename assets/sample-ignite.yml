version: "1"

staging:
  fallback: false
  provision:
    vmware-fusion:
      rootdir: /Applications/VMware Fusion.app
      display: nogui
      state: hard

workspace:
  mysql-cluster:
    description: |
      mysql innodb cluster deployed in CentOS 8.
    provider: vmware-fusion
    workdir: ~/Apple/var/VMware/mysql-cluster
    units:
      mysql-router:
        path: mysql-router.vmwarevm/mysql-router.vmx
        host:
          -192.168.117.141
        dependencies:
          - mysql-master
          - mysql-node-1
          - mysql-node-2
          - mysql-node-3
      mysql-master:
        path: mysql-master.vmwarevm/mysql-master.vmx
        host: 192.168.117.139
      mysql-node1:
        path: mysql-node-1.vmwarevm/mysql-node-1.vmx
        host: 192.168.117.140
        dependencies:
          - mysql-master
      mysql-node2:
        path: mysql-node-2.vmwarevm/mysql-node-2.vmx
        host: 192.168.117.141
        dependencies:
          - mysql-master
      mysql-node3:
        path: mysql-node-3.vmwarevm/mysql-node-3.vmx
        host: 192.168.117.142
        dependencies:
          - mysql-master

  k8s-focal:
    description: |
      kubernetes deployed in ubuntu focal fossa.
    provider: vmware-fusion
    workdir: ~/Apple/var/VMware/k8s-focal
    units:
      k8s-registry:
        path: k8s-registry.vmwarevm/k8s-registr.vmx
        host:
          - 192.168.117.151
          - 172.16.258.43
      k8s-master-1:
        path: k8s-master-1.vmwarevm/k8s-master-1.vmx
        host:
          - 192.168.117.143
          - 172.16.258.39
      k8s-master-2:
        path: k8s-master-2.vmwarevm/k8s-master-2.vmx
        host:
          - 192.168.117.144
          - 172.16.258.40
      k8s-master-3:
        path: k8s-master-3.vmwarevm/k8s-master-3.vmx
        host:
          - 192.168.117.145
          - 172.16.258.41
      k8s-node-1:
        path: k8s-master-1.vmwarevm/k8s-node-1.vmx
        host:
          - 192.168.117.146
          - 172.16.258.42
        dependencies:
          - k8s-master-1
          - k8s-master-2
          - k8s-master-3
      k8s-node-2:
        path: k8s-master-2.vmwarevm/k8s-node-2.vmx
        host:
          - 192.168.117.147
          - 172.16.258.43
        dependencies:
          - k8s-master-1
          - k8s-master-2
          - k8s-master-3
      k8s-node-3:
        path: k8s-master-3.vmwarevm/k8s-node-3.vmx
        host:
          - 192.168.117.148
          - 172.16.258.44
        dependencies:
          - k8s-master-1
          - k8s-master-2
          - k8s-master-3
